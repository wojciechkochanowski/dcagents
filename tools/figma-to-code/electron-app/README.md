# Figma Components Viewer

Electron-based desktop app for browsing, previewing, and generating Figma-derived React components produced by the `figma-to-code` CLI.

## Features
- Component library sidebar with stats, deletion, and path copy helper
- Live preview bundled via esbuild-on-demand inside a sandboxed iframe
- File tree + manifest viewer with syntax highlighting
- Generator modal that streams progress events from the main process
- Light/dark theme toggle with persistence

## Directory Layout
- `main/` Electron main process (IPC handlers, bundler, scanner)
- `preload/` Secure bridge exposing approved IPC APIs
- `renderer/` React UI powered by Vite + Tailwind
- `dist/` Compiled output (created by `pnpm run build`)
- `release/` Installer artifacts generated by electron-builder

## Development
```bash
pnpm install
pnpm run dev
```
`dev` runs a full build (main/preload/renderer) and launches Electron pointing at the built renderer bundle. Use `VITE_DEV_SERVER_URL` to point at a running Vite dev server if preferred.

## Building
All build commands run TypeScript/Vite builds first.
```bash
pnpm run package   # All platforms configured in electron-builder.json (from the host OS)
pnpm run build:mac # macOS dmg + zip
pnpm run build:win # Windows nsis + zip
pnpm run build:linux # Linux AppImage (add more targets if needed)
```
Artifacts are written to `release/`.

## Usage
- Generate components via the **Generate** button; paste a Figma URL or node id and optional name.
- Select a component to see preview/files/manifest. The preview is bundled per-request; use **Reload** or **Retry** on errors to refresh the bundle and iframe.
- Copy the on-disk path from the header button for downstream automation/agents.
- Toggle **Light/Dark mode** in the header; preference persists in `localStorage`.

## Preview Sandbox Notes
- Bundles are executed inside a sandboxed iframe (`allow-scripts` + `allow-same-origin`) with isolated styles and teardown on unmount/reload to avoid leaking roots/listeners.
- Render errors are surfaced with a retry action that re-bundles through IPC.

## Testing Checklist
- Generate → preview → delete happy path across a few Figma components.
- Validate preview reload/retry after an intentional error (e.g., break an import).
- Verify file tree browsing + syntax highlighting.
- Toggle light/dark themes and ensure gradients/panels switch cleanly.
- Clipboard copy path works and shows a toast.

## Troubleshooting
- If previews fail, use **Retry** to request a fresh bundle and **Refresh frame** to remount the iframe.
- Ensure `components/` exists at the repo root; the scanner and generator expect that path.
- When packaging, clear old outputs (`release/`) if you change build config.
